{"version":3,"file":"slate-react-placeholder.es.js","sources":["../../../node_modules/tiny-invariant/dist/tiny-invariant.esm.js","../src/index.js"],"sourcesContent":["var isProduction = process.env.NODE_ENV === 'production';\nvar prefix = 'Invariant failed';\nvar index = (function (condition, message) {\n  if (condition) {\n    return;\n  }\n\n  if (isProduction) {\n    throw new Error(prefix);\n  } else {\n    throw new Error(prefix + \": \" + (message || ''));\n  }\n});\n\nexport default index;\n","import invariant from 'tiny-invariant'\nimport React from 'react'\n\n/*\n * Instance counter to enable unique marks for multiple Placeholder instances.\n */\n\nlet instanceCounter = 0\n\n/**\n * A plugin that renders a React placeholder for a given Slate node.\n *\n * @param {Object} options\n * @return {Object}\n */\n\nfunction SlateReactPlaceholder(options = {}) {\n  const instanceId = instanceCounter++\n  const { placeholder, when, style = {} } = options\n\n  invariant(\n    typeof placeholder === 'string',\n    'You must pass `SlateReactPlaceholder` an `options.placeholder` string.'\n  )\n\n  invariant(\n    typeof when === 'string' || typeof when === 'function',\n    'You must pass `SlateReactPlaceholder` an `options.when` query.'\n  )\n\n  /**\n   * Decorate a match node with a placeholder mark when it fits the query.\n   *\n   * @param {Node} node\n   * @param {Editor} editor\n   * @param {Function} next\n   * @return {Array}\n   */\n\n  function decorateNode(node, editor, next) {\n    if (!editor.query(when, node)) {\n      return next()\n    }\n\n    const others = next()\n    const [first] = node.texts()\n    const [last] = node.texts({ direction: 'backward' })\n    const [firstNode, firstPath] = first\n    const [lastNode, lastPath] = last\n    const decoration = {\n      type: 'placeholder',\n      data: { key: instanceId },\n      anchor: { key: firstNode.key, offset: 0, path: firstPath },\n      focus: {\n        key: lastNode.key,\n        offset: lastNode.text.length,\n        path: lastPath,\n      },\n    }\n\n    return [...others, decoration]\n  }\n\n  /**\n   * Render an inline placeholder for the placeholder mark.\n   *\n   * @param {Object} props\n   * @param {Editor} editor\n   * @param {Function} next\n   * @return {Element}\n   */\n\n  function renderDecoration(props, editor, next) {\n    const { children, decoration: deco } = props\n\n    if (deco.type === 'placeholder' && deco.data.get('key') === instanceId) {\n      const placeHolderStyle = {\n        pointerEvents: 'none',\n        display: 'inline-block',\n        width: '0',\n        maxWidth: '100%',\n        whiteSpace: 'nowrap',\n        opacity: '0.333',\n        verticalAlign: 'text-top',\n        ...style,\n      }\n\n      return (\n        <span>\n          <span contentEditable={false} style={placeHolderStyle}>\n            {placeholder}\n          </span>\n          {children}\n        </span>\n      )\n    }\n\n    return next()\n  }\n\n  /**\n   * Return the plugin.\n   *\n   * @return {Object}\n   */\n\n  return { decorateNode, renderDecoration }\n}\n\n/**\n * Export.\n *\n * @type {Function}\n */\n\nexport default SlateReactPlaceholder\n"],"names":["instanceCounter","SlateReactPlaceholder","options","instanceId","placeholder","when","style","decorateNode","node","editor","next","query","others","texts","first","direction","last","firstNode","firstPath","lastNode","lastPath","decoration","key","offset","path","text","length","renderDecoration","props","children","deco","type","data","get","placeHolderStyle"],"mappings":";;AAAA,IAAI,YAAY,GAAG,aAAoB,KAAK,YAAY,CAAC;AACzD,IAAI,MAAM,GAAG,kBAAkB,CAAC;AAChC,IAAI,KAAK,IAAI,UAAU,SAAS,EAAE,OAAO,EAAE;EACzC,IAAI,SAAS,EAAE;IACb,OAAO;GACR;;EAED,IAAI,YAAY,EAAE;IAChB,MAAM,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC;GACzB,MAAM;IACL,MAAM,IAAI,KAAK,CAAC,MAAM,GAAG,IAAI,IAAI,OAAO,IAAI,EAAE,CAAC,CAAC,CAAC;GAClD;CACF,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACTF;;;;AAIA,IAAIA,kBAAkB,CAAtB;;;;;;;;;AASA,SAASC,qBAAT,GAA6C;MAAdC,OAAc,uEAAJ,EAAI;;MACrCC,aAAaH,iBAAnB;MACQI,WAFmC,GAEDF,OAFC,CAEnCE,WAFmC;MAEtBC,IAFsB,GAEDH,OAFC,CAEtBG,IAFsB;uBAEDH,OAFC,CAEhBI,KAFgB;MAEhBA,KAFgB,kCAER,EAFQ;;;QAKzC,OAAOF,WAAP,KAAuB,QADzB,EAEE,wEAFF;;QAME,OAAOC,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,IAAP,KAAgB,UAD9C,EAEE,gEAFF;;;;;;;;;;;WAcSE,YAAT,CAAsBC,IAAtB,EAA4BC,MAA5B,EAAoCC,IAApC,EAA0C;QACpC,CAACD,OAAOE,KAAP,CAAaN,IAAb,EAAmBG,IAAnB,CAAL,EAA+B;aACtBE,MAAP;;;QAGIE,SAASF,MAAf;;sBACgBF,KAAKK,KAAL,EANwB;;QAMjCC,KANiC;;uBAOzBN,KAAKK,KAAL,CAAW,EAAEE,WAAW,UAAb,EAAX,CAPyB;;QAOjCC,IAPiC;;+BAQTF,KARS;QAQjCG,SARiC;QAQtBC,SARsB;;8BASXF,IATW;QASjCG,QATiC;QASvBC,QATuB;;QAUlCC,aAAa;YACX,aADW;YAEX,EAAEC,KAAKnB,UAAP,EAFW;cAGT,EAAEmB,KAAKL,UAAUK,GAAjB,EAAsBC,QAAQ,CAA9B,EAAiCC,MAAMN,SAAvC,EAHS;aAIV;aACAC,SAASG,GADT;gBAEGH,SAASM,IAAT,CAAcC,MAFjB;cAGCN;;KAPV;;uCAWWR,MAAX,IAAmBS,UAAnB;;;;;;;;;;;;WAYOM,gBAAT,CAA0BC,KAA1B,EAAiCnB,MAAjC,EAAyCC,IAAzC,EAA+C;QACrCmB,QADqC,GACND,KADM,CACrCC,QADqC;QACfC,IADe,GACNF,KADM,CAC3BP,UAD2B;;;QAGzCS,KAAKC,IAAL,KAAc,aAAd,IAA+BD,KAAKE,IAAL,CAAUC,GAAV,CAAc,KAAd,MAAyB9B,UAA5D,EAAwE;UAChE+B;uBACW,MADX;iBAEK,cAFL;eAGG,GAHH;kBAIM,MAJN;oBAKQ,QALR;iBAMK,OANL;uBAOW;SACZ5B,KARC,CAAN;;aAYE;;;;;YACQ,iBAAiB,KAAvB,EAA8B,OAAO4B,gBAArC;;SADF;;OADF;;;WAUKxB,MAAP;;;;;;;;;SASK,EAAEH,0BAAF,EAAgBoB,kCAAhB,EAAP;;;;;"}