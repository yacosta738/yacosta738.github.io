---
import SocialLinks from "@/components/molecules/SocialLinks.astro";
import { SITE_TITLE } from "@/configs/site.consts";
import { filterMenuItems, navLinks } from "@/core/menu";
import { type Lang, useTranslatedPath, useTranslations } from "@/i18n";
import Logo from "../atoms/Logo.astro";

const currentLocale = Astro.currentLocale as Lang;
const t = useTranslations(currentLocale);
const translatePath = useTranslatedPath(currentLocale);
const localizedSiteTitle =
	typeof SITE_TITLE === "string"
		? SITE_TITLE
		: SITE_TITLE[currentLocale] || SITE_TITLE.en;

const socials = [
	{
		name: "Twitter",
		url: "https://x.com/yacosta738",
		icon: "simple-icons:x",
	},
	{
		name: "GitHub",
		url: "https://github.com/yacosta738",
		icon: "simple-icons:github",
	},
	{ name: "RSS", url: translatePath("/rss.xml"), icon: "lucide:rss" },
];

const filteredNavLinks = filterMenuItems(navLinks);

const totalLinks = filteredNavLinks.length;
const optimalColumns = totalLinks <= 4 ? 1 : 2;
const columnsClass = optimalColumns === 1 ? "md:grid-cols-1" : "md:grid-cols-2";
---

<footer
	class="relative flex justify-center items-center px-4 py-8 bg-bg-light dark:bg-bg-dark transition-colors duration-350"
>
	<div class="container mx-auto px-4">
		<div class="mb-6 md:mb-10 flex justify-between flex-wrap gap-6">
			<div class="w-full max-w-80">
				<Logo currentLocale={currentLocale} />
				<p
					class="mt-2.5 mb-5 font-inter text-sm font-normal text-footer-description-light dark:text-footer-description-dark"
				>
					{t("blog.footer.description")}
				</p>
				<SocialLinks socials={socials} />
			</div>
			<div class="w-full md:w-auto">
				<nav>
					<ul
						class={`grid grid-cols-1 ${columnsClass} gap-x-12 gap-y-3 auto-rows-auto`}
						style={optimalColumns === 2
							? `grid-template-rows: repeat(${Math.ceil(totalLinks / 2)}, auto)`
							: ""}
					>
						{
							filteredNavLinks.map((link) => (
								<li>
									<a
										href={translatePath(link.href)}
										aria-label={
											link.ariaLabelKey
												? t(link.ariaLabelKey)
												: undefined
										}
										target={link.target}
									>
										{t(link.translationKey)}
									</a>
								</li>
							))
						}
					</ul>
				</nav>
			</div>
		</div>
		<p
			class="text-footer-copyright-light dark:text-footer-copyright-dark text-xs font-inter font-normal leading-[140%] tracking-normal"
		>
			{t("blog.footer.copyright")} Â© {new Date().getFullYear()}
			{localizedSiteTitle}
		</p>
	</div>
</footer>
